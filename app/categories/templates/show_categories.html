{% extends "layout.html" %}
{% block content %}
<div style="display: flex; flex-direction: row; justify-content: flex-start; background-color: #FFFFFF; padding: 20px;">
    <!-- Categories List -->
    <div id="categories-list" style="padding: 15px; box-shadow: 2px 2px 5px rgba(0,0,0,0.1); width: 100%; background-color: #FFFFFF;">
        <table style="width: 100%; border-collapse: collapse; text-align: left; font-size: 14px; color: #333333;">
            <thead style="background-color: #E6E6FA; color: #DE3163; font-size: 18px;">
                <tr>
                    <th style="padding: 10px; border: 1px solid #DDD;"></th> <!-- For icon -->
                    <th style="padding: 10px; border: 1px solid #DDD;">Category</th>
                    <th style="padding: 10px; border: 1px solid #DDD;">Description</th>
                    <th style="padding: 10px; border: 1px solid #DDD;"></th> <!-- For edit action-->
                    <th style="padding: 10px; border: 1px solid #DDD;"></th> <!-- For delete action-->
                </tr>
            </thead>
            <tbody>
                {% for category in categories %}
                <tr style="background-color: {% if loop.index0 % 2 == 0 %} #FFFFFF {% else %} #F5F5F5 {% endif %};">
                    <td style="padding: 0; border: 1px solid #DDD; text-align: center;">
                        <img src="{{ category_icons[category.id] }}" alt="{{ category.id }} icon" style="width:24px; height:24px;">
                    </td>
                    <td style="padding: 10px; border: 1px solid #DDD;">{{ category.name }}</td>
                    <td style="padding: 10px; border: 1px solid #DDD;">{{ category.description }}</td>
                    <td style="padding: 10px; border: 1px solid #DDD;">
                        <!-- EDIT ACTION -->
                            <a href="{{ url_for('categories.edit_category', id=category.id) }}" class="edit-btn" style="color: #4B0082;">
                                <i class="fa-regular fa-pen-to-square"></i>
                            </a>
                            <form id="edit-form-{{ category.id }}" action="{{ url_for('categories.edit_category', id=category.id) }}" method="POST" style="display: none;">
                                <input type="hidden" name="_method" value="DELETE">
                            </form>
                    </td>
                    <td style="padding: 10px; border: 1px solid #DDD;">
                        <div style="display: flex; justify-content: center; align-items: center; gap: 0;">
                                <!-- DELETE ACTION -->
                                <a href="{{ url_for('categories.delete_category', id=category.id) }}" class="delete-btn" style="display: flex; justify-content: center; align-items: center; width: 24px; height: 24px; text-align: center; color: #4B0082;" onclick="confirmDelete(event, {{ category.id }});">
                                    <i class="fas fa-trash-alt"></i>
                                </a>
                                <form id="delete-form-{{ category.id }}" action="{{ url_for('categories.delete_category', id=category.id) }}" method="POST" style="display: none;">
                                    <input type="hidden" name="_method" value="DELETE">
                                </form>
                            </div>
                            <script>
                                function confirmDelete(event, categoryId) {
                                    event.preventDefault();
                                    if (confirm("Are you sure you want to delete this category?")) {
                                        document.getElementById('delete-form-' + categoryId).submit();
                                    }
                                }
                            </script>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}